<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>HTORI ERP - STOCK</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body { margin:0; font-family:Arial }
header { background:#1f3c88; color:#fff; padding:12px }
.wrap { display:flex; height:100vh }
nav { width:180px; background:#111; padding:10px }
nav button { width:100%; margin-bottom:6px; padding:8px; color:#fff; background:#333; border:none }
main { flex:1; padding:20px }

.form-box { max-width:480px }
label { font-size:14px }
input { width:100%; padding:6px; margin-bottom:8px }

table { border-collapse:collapse; width:100% }
th, td { border:1px solid #ccc; padding:6px }
</style>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>

<body>

<header>HTORI ERP (STOCK)</header>

<div class="wrap">
<nav>
  <button onclick="showPurchase()">Purchase</button>
  <button onclick="showStock()">Stock</button>
</nav>

<main id="content"></main>
</div>

<script>
// üî¥ Firebase ÏÑ§Ï†ï (Ïó¨Í∏∞ Íº≠ ÍµêÏ≤¥)
firebase.initializeApp({
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_DOMAIN",
  databaseURL: "YOUR_DB_URL",
  projectId: "YOUR_PROJECT_ID"
});
const db = firebase.database();

// ================== Purchase ==================
function showPurchase(){
  content.innerHTML = `
    <h2>Purchase (ÏûÖÍ≥†)</h2>
    <div class="form-box">
      <label>Date</label>
      <input id="p_date" type="date">

      <label>Code</label>
      <input id="p_code">

      <label>Name</label>
      <input id="p_name">

      <label>Qty</label>
      <input id="p_qty" type="number">

      <button onclick="savePurchase()">Save Purchase</button>
    </div>
  `;
}

function savePurchase(){
  const code = p_code.value.trim();
  const name = p_name.value.trim();
  const qty  = Number(p_qty.value);

  if(!code || qty<=0){
    alert("ÏûÖÎ†• Ïò§Î•ò");
    return;
  }

  db.ref("stock/"+code).once("value").then(s=>{
    const cur = s.val()?.qty || 0;
    db.ref("stock/"+code).set({
      code, name, qty: cur + qty
    }).then(()=>{
      alert("ÏûÖÍ≥† Ï†ÄÏû• ÏôÑÎ£å");
      showStock();
    });
  });
}

// ================== Stock ==================
function showStock(){
  content.innerHTML = `<h2>Stock</h2><div id="tbl">Loading...</div>`;
  db.ref("stock").once("value").then(s=>{
    const d = s.val()||{};
    let html = `<table><tr><th>Code</th><th>Name</th><th>Qty</th></tr>`;
    Object.values(d).forEach(v=>{
      html+=`<tr><td>${v.code}</td><td>${v.name}</td><td>${v.qty}</td></tr>`;
    });
    html+=`</table>`;
    tbl.innerHTML = html;
  });
}

showPurchase();
</script>

</body>
</html>
