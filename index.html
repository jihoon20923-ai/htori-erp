<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>HTORI ERP – Employee Master</title>

<style>
body{font-family:Arial;background:#f4f6f9;margin:0}
header{background:#1f3c88;color:#fff;padding:12px 20px;font-size:18px}
.wrap{padding:20px;max-width:1300px}
input,select{padding:6px;margin:4px;width:220px}
table{border-collapse:collapse;width:100%;background:#fff;margin-top:10px}
th,td{border:1px solid #ccc;padding:6px}
th{background:#eee}
tr:hover{background:#ffffcc;cursor:pointer}
button{padding:6px 14px;margin:4px}
</style>

</head>

<body>

<header>HTORI ERP – Employee Master</header>

<div class="wrap">

<h2>Employee Registration</h2>

<input id="emp_id" placeholder="Employee ID">
<input id="emp_name" placeholder="Name">
<input id="emp_birth" type="date" placeholder="Birthdate">
<br>
<input id="emp_phone" placeholder="Phone">
<input id="emp_addr" placeholder="Address">
<select id="emp_rel">
  <option>Islam</option>
  <option>Kristen</option>
  <option>Buddha</option>
  <option>Hindu</option>
  <option>Konghucu</option>
</select>
<br>
<select id="emp_type">
  <option value="PKWT">PKWT</option>
  <option value="PKWTT">PKWTT</option>
  <option value="Trainer">Trainer</option>
</select>

<select id="emp_salary_type">
  <option value="salary">고정급</option>
  <option value="hourly">시간제</option>
  <option value="piece">단가제</option>
</select>

<input id="emp_salary_base" placeholder="Base Salary(Rp)">
<input id="emp_salary_hour" placeholder="Pay per Hour(Rp)">
<input id="emp_salary_piece" placeholder="Pay per Piece(Rp)">
<br>
<input id="emp_bank" placeholder="Bank Name">
<input id="emp_bank_acc" placeholder="Account No">
<input id="emp_tax" placeholder="Tax Number">
<input id="emp_join" type="date" placeholder="Join Date">
<br>
<input id="emp_memo" placeholder="Memo" style="width:460px">

<br>
<button onclick="saveEmployee()">Save</button>
<button onclick="resetForm()">Reset</button>

<h2>Employee List</h2>
<table>
<thead>
<tr>
<th>ID</th><th>Name</th><th>Employment</th><th>Salary Type</th><th>Birth</th><th>Bank</th>
</tr>
</thead>
<tbody id="empBody"></tbody>
</table>

</div>


<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// firebase init
firebase.initializeApp({
 apiKey:"AIzaSyARxh0wfAo2RMz_-3KsWUUQYfND_F3_3fI",
 authDomain:"htori-erp-38ed1.firebaseapp.com",
 databaseURL:"https://htori-erp-38ed1-default-rtdb.asia-southeast1.firebasedatabase.app",
 projectId:"htori-erp-38ed1"
});
const db=firebase.database();

function saveEmployee(){
  const obj={
    id:emp_id.value.trim(),
    name:emp_name.value.trim(),
    birth:emp_birth.value,
    phone:emp_phone.value.trim(),
    addr:emp_addr.value.trim(),
    religion:emp_rel.value,
    employment:emp_type.value,
    salaryType:emp_salary_type.value,
    baseSalary:+emp_salary_base.value.replace(/,/g,"")||0,
    payHour:+emp_salary_hour.value.replace(/,/g,"")||0,
    payPiece:+emp_salary_piece.value.replace(/,/g,"")||0,
    bank:emp_bank.value.trim(),
    bankAcc:emp_bank_acc.value.trim(),
    tax:emp_tax.value.trim(),
    join:emp_join.value,
    memo:emp_memo.value.trim()
  }

  if(!obj.id) return alert("Employee ID required")

 db.ref("employees/"+obj.id).set(obj)
 .then(()=>{
   alert("Saved")
   resetForm()
   loadEmployees()
 })
}

function resetForm(){
 document.querySelectorAll("input").forEach(i=>i.value="")
 emp_type.value="PKWT"
 emp_salary_type.value="salary"
}

function loadEmployees(){
 empBody.innerHTML=""
 db.ref("employees").once("value").then(snap=>{
   snap.forEach(row=>{
     const e=row.val()
     empBody.innerHTML+=`
       <tr onclick="editEmployee('${e.id}')">
         <td>${e.id}</td>
         <td>${e.name}</td>
         <td>${e.employment}</td>
         <td>${e.salaryType}</td>
         <td>${e.birth||""}</td>
         <td>${e.bank||""}</td>
       </tr>
     `
   })
 })
}

function editEmployee(id){
 db.ref("employees/"+id).once("value").then(s=>{
   const e=s.val()
   emp_id.value=e.id
   emp_name.value=e.name
   emp_birth.value=e.birth
   emp_phone.value=e.phone
   emp_addr.value=e.addr
   emp_rel.value=e.religion
   emp_type.value=e.employment
   emp_salary_type.value=e.salaryType
   emp_salary_base.value=e.baseSalary
   emp_salary_hour.value=e.payHour
   emp_salary_piece.value=e.payPiece
   emp_bank.value=e.bank
   emp_bank_acc.value=e.bankAcc
   emp_tax.value=e.tax
   emp_join.value=e.join
   emp_memo.value=e.memo
 })
}

loadEmployees()
</script>
</body>
</html>
