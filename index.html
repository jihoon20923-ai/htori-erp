<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>HTORI ERP</title>

<style>
body{margin:0;font-family:Arial}
#loginBox{position:fixed;inset:0;display:flex;align-items:center;justify-content:center}
.login-card{border:1px solid #ccc;padding:30px;width:360px;text-align:center}
#erp{display:none}
.sidebar{position:fixed;top:0;left:0;width:180px;height:100vh;background:#222;color:#fff}
.sidebar div{padding:14px;cursor:pointer}
.sidebar div:hover{background:#444}
.content{margin-left:180px;padding:20px}
h2{font-size:22px}
table{width:100%;border-collapse:collapse;margin-top:10px;font-size:14px}
th,td{border:1px solid #ccc;padding:6px}
button.small{font-size:12px;padding:2px 6px}
input,select,button{font-size:14px;padding:4px}
</style>
</head>

<body>

<div id="loginBox">
  <div class="login-card">
    <h2>HTORI ERP LOGIN</h2>
    <input id="loginId" placeholder="admin">
    <input id="loginPw" type="password" placeholder="1234">
    <button onclick="login()">Login</button>
  </div>
</div>

<div id="erp">
  <div class="sidebar">
    <div onclick="page('stock')">Stock</div>
    <div onclick="page('purchase')">Purchase</div>
    <div onclick="logout()">Logout</div>
  </div>
  <div class="content" id="content"></div>
</div>

<script>
/* LOGIN */
function login(){
  if(loginId.value==="admin"&&loginPw.value==="1234"){
    localStorage.setItem("login","Y");
    loginBox.style.display="none";erp.style.display="block";page("stock");
  }
}
function logout(){localStorage.removeItem("login");location.reload()}
if(localStorage.getItem("login")==="Y"){loginBox.style.display="none";erp.style.display="block"}

/* STORAGE */
const getP=()=>JSON.parse(localStorage.getItem("purchase")||"[]");
const saveP=d=>localStorage.setItem("purchase",JSON.stringify(d));

/* STOCK = 집계 */
function page(p){
  if(p==="stock"){
    const map={};
    getP().forEach(i=>{
      if(!map[i.code])map[i.code]={name:i.name,qty:0};
      map[i.code].qty+=i.qty;
    });
    content.innerHTML=`
      <h2>Stock (Read Only)</h2>
      <table><tr><th>Code</th><th>Name</th><th>Qty</th></tr>
      ${Object.keys(map).map(c=>`
        <tr><td>${c}</td><td>${map[c].name}</td><td>${map[c].qty}</td></tr>`).join("")}
      </table>`;
  }

  if(p==="purchase"){
    content.innerHTML=`
      <h2>Purchase</h2>
      <input type="date" id="d">
      <select id="t"><option>Container</option><option>Air</option></select>
      <input id="c" placeholder="Code">
      <input id="n" placeholder="Name">
      <input id="q" type="number" placeholder="Qty">
      <button onclick="add()">Add</button>

      <table>
        <tr><th>Date</th><th>Type</th><th>Code</th><th>Name</th><th>Qty</th><th>Action</th></tr>
        ${getP().map((i,idx)=>`
          <tr>
            <td>${i.date}</td><td>${i.type}</td><td>${i.code}</td><td>${i.name}</td><td>${i.qty}</td>
            <td>
              <button class="small" onclick="edit(${idx})">Edit</button>
              <button class="small" onclick="del(${idx})">Del</button>
            </td>
          </tr>`).join("")}
      </table>`;
    d.value=new Date().toISOString().slice(0,10);
  }
}

function add(){
  const p=getP();
  p.push({date:d.value,type:t.value,code:c.value,name:n.value,qty:Number(q.value)});
  saveP(p);page("purchase");
}

function edit(i){
  const p=getP();const x=p[i];
  d.value=x.date;t.value=x.type;c.value=x.code;n.value=x.name;q.value=x.qty;
  p.splice(i,1);saveP(p);page("purchase");
}
function del(i){const p=getP();p.splice(i,1);saveP(p);page("purchase")}
</script>

</body>
</html>
